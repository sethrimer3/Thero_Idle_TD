<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Thero Idle</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@500;600&family=Great+Vibes&family=Space+Mono:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="./assets/styles.css" />
    <script>
      window.MathJax = {
        tex: {
          inlineMath: [
            ['\\(', '\\)'],
            ['$', '$'],
          ],
          displayMath: [
            ['\\[', '\\]'],
          ],
          packages: { '[+]': ['color', 'html'] },
        },
        options: {
          renderActions: {
            addMenu: [],
          },
        },
      };
    </script>
    <script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  </head>
  <body>
    <div class="startup-overlay" id="startup-overlay" role="status" aria-live="polite">
      <div class="startup-overlay__content" role="presentation">
        <!-- Allow the logo animation to run even when low graphics mode disables other animations. -->
        <img
          class="startup-overlay__logo"
          src="./assets/sprites/gravy_thyme_logo.png"
          alt="Thero Idle sigil"
          data-startup-logo
          data-allow-animation
        />
        <!-- Keep the loading glyph animated on mobile by opting it into animations explicitly. -->
        <div
          class="startup-overlay__loading"
          data-startup-loading
          role="img"
          aria-label="Loading glyph animation"
          data-allow-animation
        ></div>
        <p class="startup-overlay__hint">Calibrating glyph lattice…</p>
      </div>
    </div>
    <div
      class="offline-overlay"
      id="offline-overlay"
      role="dialog"
      aria-modal="true"
      aria-hidden="true"
      tabindex="-1"
      hidden
    >
      <div class="offline-overlay__content">
        <p class="offline-overlay__title">Idle Mote Harvest</p>
        <div class="offline-overlay__equation" aria-live="polite">
          <span class="offline-number" id="offline-minutes">0</span>
          <span class="offline-symbol">×</span>
          <span class="offline-number" id="offline-rate">0</span>
          <span class="offline-symbol">=</span>
          <span class="offline-number" id="offline-total">0</span>
        </div>
        <p class="offline-overlay__prompt" id="offline-prompt" aria-live="polite">
          <em>Press anywhere to continue.</em>
        </p>
      </div>
    </div>
    <div class="app-shell">
      <main class="main-stage">
        <section
          class="panel active"
          data-panel="tower"
          id="panel-tower"
          role="tabpanel"
          aria-labelledby="tab-tower"
        >
          <section class="playfield-wrapper" id="playfield-wrapper" aria-live="polite">
            <div class="playfield-shell">
              <div
                class="playfield"
                id="playfield"
                role="img"
                aria-label="Interactive glyph defense lane"
              >
                <!-- Playfield menu surfaces layout toggles when a level is active. -->
                <button
                  class="playfield-menu-button"
                  type="button"
                  id="playfield-menu-button"
                  aria-label="Open playfield menu"
                  aria-controls="playfield-menu-panel"
                  aria-expanded="false"
                >
                  ☰
                </button>
                <div class="playfield-menu-panel" id="playfield-menu-panel" role="menu" hidden>
                  <!-- Replicate the stage control commence trigger within the quick menu. -->
                  <button
                    class="playfield-menu-item"
                    type="button"
                    id="playfield-menu-commence"
                    role="menuitem"
                  >
                    Commence Wave
                  </button>
                  <button
                    class="playfield-menu-item"
                    type="button"
                    id="playfield-menu-level-select"
                    role="menuitem"
                  >
                    Level Selection
                  </button>
                  <button
                    class="playfield-menu-item"
                    type="button"
                    id="playfield-menu-retry-wave"
                    role="menuitem"
                  >
                    Retry Wave
                  </button>
                  <button
                    class="playfield-menu-item"
                    type="button"
                    id="playfield-menu-dev-tools"
                    role="menuitem"
                  >
                    Dev Map Tools
                  </button>
                  <button
                    class="playfield-menu-item"
                    type="button"
                    id="playfield-speed"
                    role="menuitem"
                  >
                    Speed ×1
                  </button>
                  <button
                    class="playfield-menu-item"
                    type="button"
                    id="playfield-auto"
                    role="menuitem"
                  >
                    Loadout Placement
                  </button>
                  <label class="playfield-menu-toggle" for="playfield-auto-wave">
                    <input type="checkbox" id="playfield-auto-wave" checked />
                    <span>Auto-send next wave</span>
                  </label>
                </div>
                <canvas id="playfield-canvas" width="560" height="360"></canvas>
                <!-- Outcome overlay dims the battlefield and surfaces victory or defeat messaging. -->
                <div
                  class="playfield-outcome"
                  id="playfield-outcome"
                  role="dialog"
                  aria-modal="true"
                  aria-hidden="true"
                  tabindex="-1"
                  hidden
                >
                  <div class="playfield-outcome__panel">
                    <p class="playfield-outcome__title" id="playfield-outcome-title"></p>
                    <p class="playfield-outcome__subtitle" id="playfield-outcome-subtitle"></p>
                    <div class="playfield-outcome__actions">
                      <button
                        class="playfield-outcome__button"
                        type="button"
                        id="playfield-outcome-primary"
                      >
                        Back to Level Selection
                      </button>
                      <button
                        class="playfield-outcome__button playfield-outcome__button--secondary"
                        type="button"
                        id="playfield-outcome-secondary"
                        hidden
                      ></button>
                    </div>
                  </div>
                </div>
                <dl class="playfield-stats" aria-live="polite">
                  <div class="playfield-stats__item">
                    <dt>Wave</dt>
                    <dd id="playfield-wave">—</dd>
                  </div>
                  <div class="playfield-stats__item">
                    <dt>Gate</dt>
                    <dd id="playfield-health">—</dd>
                  </div>
                  <div class="playfield-stats__item">
                    <dt>Thero</dt>
                    <dd id="playfield-energy">—</dd>
                  </div>
                </dl>
                <div class="tower-loadout" id="tower-loadout" aria-label="Tower loadout" role="region">
                  <p class="tower-loadout-note screen-reader-only" id="tower-loadout-note">
                    Select four towers to bring into the defense. Drag the glyph chips onto the plane to
                    lattice them; drop a chip atop a matching tower to merge into the next tier.
                  </p>
                  <div class="tower-loadout-grid" id="tower-loadout-grid" role="list"></div>
                </div>
              </div>
              <section
                class="overlay-editor"
                id="overlay-level-editor"
                hidden
                aria-hidden="true"
                role="region"
                aria-labelledby="level-editor-title"
              >
                <header class="overlay-editor__header">
                  <h3 class="overlay-editor__title" id="level-editor-title">Level Editor</h3>
                  <button
                    class="overlay-editor__toggle"
                    type="button"
                    id="level-editor-toggle"
                    aria-pressed="false"
                  >
                    Enable Editing
                  </button>
                </header>
                <p class="overlay-editor__note" id="level-editor-note">
                  Click the battlefield to place anchors. Drag markers to adjust, or Shift-click to remove the nearest anchor.
                  <span class="overlay-editor__count" id="level-editor-count">0 points</span>
                </p>
                <div class="overlay-editor__actions">
                  <button class="overlay-editor__button" type="button" id="level-editor-clear" disabled>
                    Clear All
                  </button>
                  <button class="overlay-editor__button" type="button" id="level-editor-reset" disabled>
                    Reset to Level Path
                  </button>
                  <button class="overlay-editor__button" type="button" id="level-editor-export" disabled>
                    Copy Path JSON
                  </button>
                </div>
                <!-- Developer map elements let designers drop experimental obstacles onto the battlefield. -->
                <div class="overlay-editor__elements" id="developer-map-elements" hidden aria-hidden="true">
                  <p class="overlay-editor__elements-title">Developer Map Elements</p>
                  <div class="overlay-editor__elements-actions">
                    <button
                      class="overlay-editor__button overlay-editor__button--primary"
                      type="button"
                      id="developer-add-crystal"
                    >
                      Place Solid Crystal
                    </button>
                    <button class="overlay-editor__button" type="button" id="developer-clear-crystals">
                      Clear Crystals
                    </button>
                  </div>
                  <p class="overlay-editor__elements-note" id="developer-map-elements-note" hidden></p>
                </div>
                <textarea
                  class="overlay-editor__output"
                  id="level-editor-output"
                  rows="6"
                  readonly
                  placeholder="Enable editing to chart a new path."
                ></textarea>
                <p class="overlay-editor__status" id="level-editor-status" role="status" aria-live="polite" hidden></p>
              </section>
            </div>
          </section>
          <section class="level-section" id="level-selection">
            <!-- Surface the live thero multiplier and starting equation at the top of the level list. -->
            <div class="level-thero-banner" id="level-thero-banner" aria-live="polite">
              <div class="level-thero-row">
                <span class="level-thero-label">Thero Multiplier</span>
                <span class="level-thero-value" id="level-thero-multiplier">×0.00</span>
              </div>
            </div>
            <header class="subsection-title">Conjecture Set</header>
            <p class="level-intro">
              The opening proofs trace immortal-defense style figure-eights,
              cardioids, and logarithmic spirals. Each path is derived from a
              math-graph expression and rewards towers that can flex their
              formulas mid-curve.
            </p>
            <div class="level-grid" id="level-grid" aria-live="polite"></div>
          </section>
        </section>

        <section
          class="panel"
          data-panel="towers"
          id="panel-towers"
          role="tabpanel"
          aria-labelledby="tab-towers"
          hidden
        >
          <!-- Present tower resource summaries near the top of the Towers tab. -->
          <div class="tower-glyph-summary" id="tower-glyph-summary" aria-live="polite">
            <div class="tower-glyph-item">
              <span class="tower-glyph-label">Total Glyphs</span>
              <span class="tower-glyph-value" id="tower-glyphs-total">0</span>
            </div>
            <div class="tower-glyph-item">
              <span class="tower-glyph-label">Unused Glyphs</span>
              <span class="tower-glyph-value" id="tower-glyphs-unused">0</span>
            </div>
          </div>
          <div class="tower-panel-controls" id="tower-panel-controls">
            <button
              class="tower-panel-button tower-tree-map-button"
              type="button"
              id="tower-tree-map-toggle"
              aria-pressed="false"
              aria-expanded="false"
              aria-controls="tower-tree-map"
              title="Open the Tower Tree Map"
            >
              <span class="tower-tree-map-icon" aria-hidden="true">
                <svg viewBox="0 0 80 80" focusable="false" aria-hidden="true">
                  <g stroke="currentColor" stroke-width="2" fill="none">
                    <path d="M18 18 L40 10 L62 18" />
                    <path d="M18 62 L40 70 L62 62" />
                    <path d="M18 18 L18 62" />
                    <path d="M62 18 L62 62" />
                    <path d="M40 10 L40 70" />
                  </g>
                  <g fill="currentColor" font-family="'Cormorant Garamond', serif" font-size="16" text-anchor="middle">
                    <circle cx="18" cy="18" r="8" fill="rgba(255,255,255,0.15)" />
                    <text x="18" y="22">α</text>
                    <circle cx="40" cy="10" r="8" fill="rgba(255,255,255,0.15)" />
                    <text x="40" y="14">β</text>
                    <circle cx="62" cy="18" r="8" fill="rgba(255,255,255,0.15)" />
                    <text x="62" y="22">γ</text>
                    <circle cx="18" cy="62" r="8" fill="rgba(255,255,255,0.15)" />
                    <text x="18" y="66">δ</text>
                    <circle cx="62" cy="62" r="8" fill="rgba(255,255,255,0.15)" />
                    <text x="62" y="66">ε</text>
                  </g>
                </svg>
              </span>
              <span class="tower-tree-map-label tower-panel-button-label">Tower Tree Map</span>
            </button>
            <button
              class="tower-panel-button tower-panel-button--variables"
              type="button"
              id="tower-variable-library"
              aria-haspopup="dialog"
              aria-controls="variable-library-overlay"
              aria-expanded="false"
            >
              <span class="tower-panel-button-icon" aria-hidden="true">Var</span>
              <span class="tower-panel-button-label">Variables</span>
            </button>
            <button
              class="tower-panel-button tower-panel-button--matrix"
              type="button"
              data-upgrade-matrix-trigger
              aria-haspopup="dialog"
              aria-controls="upgrade-matrix-overlay"
              aria-expanded="false"
            >
              <span class="tower-panel-button-icon" aria-hidden="true">⧉</span>
              <span class="tower-panel-button-label">Upgrade Matrix</span>
            </button>
          </div>
          <div
            class="tower-tree-map"
            id="tower-tree-map"
            role="region"
            aria-label="Tower Tree Map"
            hidden
            aria-hidden="true"
          >
            <svg class="tower-tree-map-links" aria-hidden="true" focusable="false"></svg>
            <div class="tower-tree-map-nodes" data-tree-node-layer></div>
            <p class="tower-tree-map-note">Only discovered towers appear in this constellation.</p>
          </div>
          <div class="panel-grid" id="tower-card-grid">
            <article class="card card--mind-gate" data-tower-id="mind-gate" aria-hidden="false">
              <header class="tower-header">
                <span class="tower-tier">Tier 0</span>
                <h3>
                  <span class="mind-gate-symbol" aria-hidden="true">
                    <img src="assets/images/tower-mind-gate.svg" alt="" />
                  </span>
                  Mind Gate
                </h3>
              </header>
              <div class="formula-block">
                <p class="formula-line">\( \wp = \text{Life} \times \text{Regeneration} \)</p>
                <ul class="formula-definition">
                  <li>Life → \( 100^{\aleph_{1} / \aleph_{2}} \)</li>
                  <li>Regeneration → \( \frac{100 \times \aleph_{2}}{\aleph_{1}} \)</li>
                </ul>
              </div>
              <ul class="upgrade-list">
                <li>Fortify \(\aleph_{1}\) to amplify Life's exponential reservoir.</li>
                <li>Stabilize \(\aleph_{2}\) so Regeneration surges refill the gate between waves.</li>
              </ul>
              <footer class="card-footer">
                The original tower—anchoring the lane's finale. When the Mind Gate collapses, inspiration runs dry.
              </footer>
            </article>
            <article class="card" data-tower-id="alpha" aria-hidden="false">
              <header class="tower-header">
                <span class="tower-tier">Tier I</span>
                <h3>α alpha tower</h3>
              </header>
              <div class="formula-block">
                <p class="formula-line">\( \alpha = \text{Attack} \times \text{Speed} \)</p>
                <ul class="formula-definition">
                  <li>Attack → projectile force braided from \(\aleph_{1}\)</li>
                  <li>Speed → oscillation cadence tuned by \(\aleph_{2}\)</li>
                </ul>
                <p class="formula-line result">\( \text{Attack} = 5 \times \aleph_{1} \)</p>
                <p class="formula-line result">\( \text{Speed} = 0.5 \times \aleph_{2} \)</p>
              </div>
              <ul class="upgrade-list">
                <li>Invest collected glyphs into \(\aleph_{1}\) to amplify Attack.</li>
                <li>Stabilize \(\aleph_{2}\) to quicken Speed and sustain tempo.</li>
              </ul>
              <footer class="card-footer">Shoots a focused glyph-bullet at the nearest foe.</footer>
              <button class="tower-equip-button" type="button" data-tower-toggle="alpha">
                Equip α
              </button>
            </article>
            <article class="card" data-tower-id="beta" hidden aria-hidden="true">
              <header class="tower-header">
                <span class="tower-tier">Tier II</span>
                <h3>β beta tower</h3>
              </header>
              <div class="formula-block">
                <p class="formula-line">\( \beta = \text{Attack} \times \text{Speed} \times \text{Range} \)</p>
                <ul class="formula-definition">
                  <li>Attack → α's output amplified by \(\aleph_{1}\)</li>
                  <li>Speed → cadence accelerated by neighbouring α lattices</li>
                  <li>Range → coverage stretched through linked α channels</li>
                </ul>
                <p class="formula-line result">\( \text{Attack} = \alpha \times \aleph_{1} \)</p>
              </div>
              <ul class="upgrade-list">
                <li>Sharpen \(\aleph_{1}\) investments to raise inherited α power.</li>
                <li>Stabilize linked α lattices to hold the beam's pulse steady.</li>
                <li>Stretch the lattice web to guide α farther downlane.</li>
              </ul>
              <footer class="card-footer">
                Emits a piercing beam amplified purely from α's output.
              </footer>
              <button class="tower-equip-button" type="button" data-tower-toggle="beta">
                Equip β
              </button>
            </article>
            <article class="card" data-tower-id="gamma" hidden aria-hidden="true">
              <header class="tower-header">
                <span class="tower-tier">Tier III</span>
                <h3>γ gamma tower</h3>
              </header>
              <div class="formula-block">
                <p class="formula-line">\( \gamma = \text{Attack} \times \text{Speed} \times \text{Range} \times \text{Pierce} \)</p>
                <ul class="formula-definition">
                  <li>Attack → β's surge braided with \(\aleph_{1}\)</li>
                  <li>Speed → cadence tuned by α lattice links</li>
                  <li>Range → arc reach extended by β conductors</li>
                  <li>Pierce → bolt depth anchored to \(\aleph_{2}\)</li>
                </ul>
                <p class="formula-line result">\( \text{Attack} = \beta \times \aleph_{1} \)</p>
                <p class="formula-line result">\( \text{Pierce} = \aleph_{2} \)</p>
              </div>
              <ul class="upgrade-list">
                <li>Channel β's beam into branching lightning arcs.</li>
                <li>Stabilize β resonance to keep the bolts on target.</li>
              </ul>
              <footer class="card-footer">Distills β into a tempo-shifting conductor with homing bolts.</footer>
              <button class="tower-equip-button" type="button" data-tower-toggle="gamma">
                Equip γ
              </button>
            </article>
            <article class="card" data-tower-id="delta" hidden aria-hidden="true">
              <header class="tower-header">
                <span class="tower-tier">Tier IV</span>
                <h3>δ delta tower</h3>
              </header>
              <div class="formula-block">
                <p class="formula-line">\( \delta = \gamma \cdot \ln(\gamma + 1) \)</p>
                <ul class="formula-definition">
                  <li>γ → conductor strength inherited from the gamma lattice</li>
                  <li>Tot → total spectral soldiers δ can field concurrently</li>
                </ul>
                <p class="formula-line result">Commands spectral cohorts scaled purely by γ.</p>
              </div>
              <ul class="upgrade-list">
                <li>Empower γ-bound soldiers with slowing sigils</li>
                <li>Rally boosts: δ cohorts grant +γ% damage to nearby towers</li>
              </ul>
              <footer class="card-footer">Does not attack directly—commands spectral fighters to guard the lane.</footer>
              <button class="tower-equip-button" type="button" data-tower-toggle="delta">
                Equip δ
              </button>
            </article>
            <article class="card" data-tower-id="epsilon" hidden aria-hidden="true">
              <header class="tower-header">
                <span class="tower-tier">Tier V</span>
                <h3>ε epsilon tower</h3>
              </header>
              <div class="formula-block">
                <p class="formula-line">\( \varepsilon = \delta^{2} \)</p>
                <ul class="formula-definition">
                  <li>δ → command strength squared into burst charges</li>
                </ul>
                <p class="formula-line result">Squares δ's cohorts into rapid-fire needle storms.</p>
              </div>
              <ul class="upgrade-list">
                <li>Focus δ energy into tighter splash windows</li>
                <li>Store δ pulses to release simultaneous volleys</li>
              </ul>
              <footer class="card-footer">Squares δ's momentum into rapid glyph needles.</footer>
              <button class="tower-equip-button" type="button" data-tower-toggle="epsilon">
                Equip ε
              </button>
            </article>
            <article class="card" data-tower-id="zeta" hidden aria-hidden="true">
              <header class="tower-header">
                <span class="tower-tier">Tier VI</span>
                <h3>ζ zeta tower</h3>
              </header>
              <div class="formula-block">
                <p class="formula-line">\( \zeta = \sqrt{\varepsilon} \)</p>
                <ul class="formula-definition">
                  <li>ε → needle storm potential moderated into harmonic splash</li>
                </ul>
                <p class="formula-line result">Roots ε into controlled harmonic cascades.</p>
              </div>
              <ul class="upgrade-list">
                <li>Focus ε residue into denser splash pools</li>
                <li>Delay the release to stack ε charges before bursting</li>
              </ul>
              <footer class="card-footer">Turns ε's swell into rolling resonance detonations.</footer>
              <button class="tower-equip-button" type="button" data-tower-toggle="zeta">
                Equip ζ
              </button>
            </article>
            <article class="card" data-tower-id="eta" hidden aria-hidden="true">
              <header class="tower-header">
                <span class="tower-tier">Tier VII</span>
                <h3>η eta tower</h3>
              </header>
              <div class="formula-block">
                <p class="formula-line">\( \eta = \ln(\zeta + 1) \)</p>
                <ul class="formula-definition">
                  <li>ζ → harmonic cascades condensed through a logarithmic focus</li>
                </ul>
                <p class="formula-line result">Condenses ζ into an armor-slicing resonance veil.</p>
              </div>
              <ul class="upgrade-list">
                <li>Widen the ζ intake to stretch the resonance veil</li>
                <li>Share η's focused field with δ soldiers to shatter shields</li>
              </ul>
              <footer class="card-footer">Extends ζ's song into a logarithmic debuff that strips defenses.</footer>
              <button class="tower-equip-button" type="button" data-tower-toggle="eta">
                Equip η
              </button>
            </article>
            <article class="card" data-tower-id="theta" hidden aria-hidden="true">
              <header class="tower-header">
                <span class="tower-tier">Tier VIII</span>
                <h3>θ theta tower</h3>
              </header>
              <div class="formula-block">
                <p class="formula-line">\( \theta = \eta^{2} \)</p>
                <ul class="formula-definition">
                  <li>η → logarithmic veil squared into lane-warping force</li>
                </ul>
                <p class="formula-line result">Squares η to bend lanes and slow invaders.</p>
              </div>
              <ul class="upgrade-list">
                <li>Amplify η before squaring to thicken slow fields</li>
                <li>Modulate η pulses to reflect enemies along mirrored paths</li>
              </ul>
              <footer class="card-footer">Projects η's strength as modular fields that reshape the curve around your towers.</footer>
              <button class="tower-equip-button" type="button" data-tower-toggle="theta">
                Equip θ
              </button>
            </article>
            <article class="card" data-tower-id="iota" hidden aria-hidden="true">
              <header class="tower-header">
                <span class="tower-tier">Tier IX</span>
                <h3>ι iota tower</h3>
              </header>
              <div class="formula-block">
                <p class="formula-line">\( \iota = \sqrt{\theta} \)</p>
                <ul class="formula-definition">
                  <li>θ → squared lane warp relaxed back into circulating beams</li>
                </ul>
                <p class="formula-line result">Loops θ into circulating glyph lasers that ride the curve.</p>
              </div>
              <ul class="upgrade-list">
                <li>Stack additional loops to layer multiple θ-derived beams</li>
                <li>Collapse the loop to detonate when enemies cross the path</li>
              </ul>
              <footer class="card-footer">Sweeps circular beams around waypoints using relaxed θ energy.</footer>
              <button class="tower-equip-button" type="button" data-tower-toggle="iota">
                Equip ι
              </button>
            </article>
            <article class="card" data-tower-id="kappa" hidden aria-hidden="true">
              <header class="tower-header">
                <span class="tower-tier">Tier X</span>
                <h3>κ kappa tower</h3>
              </header>
              <div class="formula-block">
                <p class="formula-line">\( \kappa = \iota + \sin(\iota) \)</p>
                <ul class="formula-definition">
                  <li>ι → circulating beam intensity feeding the curvature</li>
                  <li>sin(ι) → oscillation that sharpens focused bursts</li>
                </ul>
                <p class="formula-line result">Bends ι's loops into oscillating kill zones.</p>
              </div>
              <ul class="upgrade-list">
                <li>Sharpen ι to intensify oscillating curvature strikes</li>
                <li>Diffuse the sine rhythm to grant allies range along curved lanes</li>
              </ul>
              <footer class="card-footer">Focuses on choke points by warping ι's rhythm around tight corners.</footer>
              <button class="tower-equip-button" type="button" data-tower-toggle="kappa">
                Equip κ
              </button>
            </article>
            <article class="card" data-tower-id="lambda" hidden aria-hidden="true">
              <header class="tower-header">
                <span class="tower-tier">Tier XI</span>
                <h3>λ lambda tower</h3>
              </header>
              <div class="formula-block">
                <p class="formula-line">\( \lambda = \kappa \times N_{\text{eff}} \)</p>
                <ul class="formula-definition">
                  <li>κ → inherited tripwire power pulled straight from Kappa</li>
                  <li>N<sub>eff</sub> → live enemy count multiplied by Aleph₃ weighting</li>
                </ul>
                <p class="formula-line result">Fires a piercing beam whose damage, colour, and wavelength scale with battlefield density.</p>
              </div>
              <ul class="upgrade-list">
                <li>Aleph₁ extends the laser by +0.5 metres per glyph, reaching distant lanes.</li>
                <li>Aleph₂ accelerates the pulse, logarithmically approaching 0.5 shots each second.</li>
                <li>Aleph₃ multiplies each enemy’s contribution, tightening wavelengths and driving the rainbow sweep.</li>
              </ul>
              <footer class="card-footer">The beam ignores the monochrome palette, cycling the visible spectrum before dissolving into a brightening sine wave.</footer>
              <button class="tower-equip-button" type="button" data-tower-toggle="lambda">
                Equip λ
              </button>
            </article>
            <article class="card" data-tower-id="mu" hidden aria-hidden="true">
              <header class="tower-header">
                <span class="tower-tier">Tier XII</span>
                <h3>μ mu tower</h3>
              </header>
              <div class="formula-block">
                <p class="formula-line">\( \mu = X \)</p>
                <ul class="formula-definition">
                  <li>Not defined yet.</li>
                </ul>
                <p class="formula-line result">Not defined yet.</p>
              </div>
              <ul class="upgrade-list">
                <li>Not defined yet.</li>
              </ul>
              <footer class="card-footer">Not defined yet.</footer>
              <button class="tower-equip-button" type="button" data-tower-toggle="mu">
                Equip μ
              </button>
            </article>
            <article class="card" data-tower-id="nu" hidden aria-hidden="true">
              <header class="tower-header">
                <span class="tower-tier">Tier XIII</span>
                <h3>ν nu tower</h3>
              </header>
              <div class="formula-block">
                <p class="formula-line">\( \nu = X \)</p>
                <ul class="formula-definition">
                  <li>Not defined yet.</li>
                </ul>
                <p class="formula-line result">Not defined yet.</p>
              </div>
              <ul class="upgrade-list">
                <li>Not defined yet.</li>
              </ul>
              <footer class="card-footer">Not defined yet.</footer>
              <button class="tower-equip-button" type="button" data-tower-toggle="nu">
                Equip ν
              </button>
            </article>
            <article class="card" data-tower-id="xi" hidden aria-hidden="true">
              <header class="tower-header">
                <span class="tower-tier">Tier XIV</span>
                <h3>ξ xi tower</h3>
              </header>
              <div class="formula-block">
                <p class="formula-line">\( \xi = X \)</p>
                <ul class="formula-definition">
                  <li>Not defined yet.</li>
                </ul>
                <p class="formula-line result">Not defined yet.</p>
              </div>
              <ul class="upgrade-list">
                <li>Not defined yet.</li>
              </ul>
              <footer class="card-footer">Not defined yet.</footer>
              <button class="tower-equip-button" type="button" data-tower-toggle="xi">
                Equip ξ
              </button>
            </article>
            <article class="card" data-tower-id="omicron" hidden aria-hidden="true">
              <header class="tower-header">
                <span class="tower-tier">Tier XV</span>
                <h3>ο omicron tower</h3>
              </header>
              <div class="formula-block">
                <p class="formula-line">\( ο = X \)</p>
                <ul class="formula-definition">
                  <li>Not defined yet.</li>
                </ul>
                <p class="formula-line result">Not defined yet.</p>
              </div>
              <ul class="upgrade-list">
                <li>Not defined yet.</li>
              </ul>
              <footer class="card-footer">Not defined yet.</footer>
              <button class="tower-equip-button" type="button" data-tower-toggle="omicron">
                Equip ο
              </button>
            </article>
            <article class="card" data-tower-id="pi" hidden aria-hidden="true">
              <header class="tower-header">
                <span class="tower-tier">Tier XVI</span>
                <h3>π pi tower</h3>
              </header>
              <div class="formula-block">
                <p class="formula-line">\( \pi = X \)</p>
                <ul class="formula-definition">
                  <li>Not defined yet.</li>
                </ul>
                <p class="formula-line result">Not defined yet.</p>
              </div>
              <ul class="upgrade-list">
                <li>Not defined yet.</li>
              </ul>
              <footer class="card-footer">Not defined yet.</footer>
              <button class="tower-equip-button" type="button" data-tower-toggle="pi">
                Equip π
              </button>
            </article>
            <article class="card" data-tower-id="rho" hidden aria-hidden="true">
              <header class="tower-header">
                <span class="tower-tier">Tier XVII</span>
                <h3>ρ rho tower</h3>
              </header>
              <div class="formula-block">
                <p class="formula-line">\( \rho = X \)</p>
                <ul class="formula-definition">
                  <li>Not defined yet.</li>
                </ul>
                <p class="formula-line result">Not defined yet.</p>
              </div>
              <ul class="upgrade-list">
                <li>Not defined yet.</li>
              </ul>
              <footer class="card-footer">Not defined yet.</footer>
              <button class="tower-equip-button" type="button" data-tower-toggle="rho">
                Equip ρ
              </button>
            </article>
            <article class="card" data-tower-id="sigma" hidden aria-hidden="true">
              <header class="tower-header">
                <span class="tower-tier">Tier XVIII</span>
                <h3>σ sigma tower</h3>
              </header>
              <div class="formula-block">
                <p class="formula-line">\( \sigma = X \)</p>
                <ul class="formula-definition">
                  <li>Not defined yet.</li>
                </ul>
                <p class="formula-line result">Not defined yet.</p>
              </div>
              <ul class="upgrade-list">
                <li>Not defined yet.</li>
              </ul>
              <footer class="card-footer">Not defined yet.</footer>
              <button class="tower-equip-button" type="button" data-tower-toggle="sigma">
                Equip σ
              </button>
            </article>
            <article class="card" data-tower-id="tau" hidden aria-hidden="true">
              <header class="tower-header">
                <span class="tower-tier">Tier XIX</span>
                <h3>τ tau tower</h3>
              </header>
              <div class="formula-block">
                <p class="formula-line">\( \tau = X \)</p>
                <ul class="formula-definition">
                  <li>Not defined yet.</li>
                </ul>
                <p class="formula-line result">Not defined yet.</p>
              </div>
              <ul class="upgrade-list">
                <li>Not defined yet.</li>
              </ul>
              <footer class="card-footer">Not defined yet.</footer>
              <button class="tower-equip-button" type="button" data-tower-toggle="tau">
                Equip τ
              </button>
            </article>
            <article class="card" data-tower-id="upsilon" hidden aria-hidden="true">
              <header class="tower-header">
                <span class="tower-tier">Tier XX</span>
                <h3>υ upsilon tower</h3>
              </header>
              <div class="formula-block">
                <p class="formula-line">\( \upsilon = X \)</p>
                <ul class="formula-definition">
                  <li>Not defined yet.</li>
                </ul>
                <p class="formula-line result">Not defined yet.</p>
              </div>
              <ul class="upgrade-list">
                <li>Not defined yet.</li>
              </ul>
              <footer class="card-footer">Not defined yet.</footer>
              <button class="tower-equip-button" type="button" data-tower-toggle="upsilon">
                Equip υ
              </button>
            </article>
            <article class="card" data-tower-id="phi" hidden aria-hidden="true">
              <header class="tower-header">
                <span class="tower-tier">Tier XXI</span>
                <h3>φ phi tower</h3>
              </header>
              <div class="formula-block">
                <p class="formula-line">\( \varphi = X \)</p>
                <ul class="formula-definition">
                  <li>Not defined yet.</li>
                </ul>
                <p class="formula-line result">Not defined yet.</p>
              </div>
              <ul class="upgrade-list">
                <li>Not defined yet.</li>
              </ul>
              <footer class="card-footer">Not defined yet.</footer>
              <button class="tower-equip-button" type="button" data-tower-toggle="phi">
                Equip φ
              </button>
            </article>
            <article class="card" data-tower-id="chi" hidden aria-hidden="true">
              <header class="tower-header">
                <span class="tower-tier">Tier XXII</span>
                <h3>χ chi tower</h3>
              </header>
              <div class="formula-block">
                <p class="formula-line">\( \chi = X \)</p>
                <ul class="formula-definition">
                  <li>Not defined yet.</li>
                </ul>
                <p class="formula-line result">Not defined yet.</p>
              </div>
              <ul class="upgrade-list">
                <li>Not defined yet.</li>
              </ul>
              <footer class="card-footer">Not defined yet.</footer>
              <button class="tower-equip-button" type="button" data-tower-toggle="chi">
                Equip χ
              </button>
            </article>
            <article class="card" data-tower-id="psi" hidden aria-hidden="true">
              <header class="tower-header">
                <span class="tower-tier">Tier XXIII</span>
                <h3>ψ psi tower</h3>
              </header>
              <div class="formula-block">
                <p class="formula-line">\( \psi = X \)</p>
                <ul class="formula-definition">
                  <li>Not defined yet.</li>
                </ul>
                <p class="formula-line result">Not defined yet.</p>
              </div>
              <ul class="upgrade-list">
                <li>Not defined yet.</li>
              </ul>
              <footer class="card-footer">Not defined yet.</footer>
              <button class="tower-equip-button" type="button" data-tower-toggle="psi">
                Equip ψ
              </button>
            </article>
            <article class="card" data-tower-id="omega" hidden aria-hidden="true">
              <header class="tower-header">
                <span class="tower-tier">Tier XXIV</span>
                <h3>Ω omega tower</h3>
              </header>
              <div class="formula-block">
                <p class="formula-line">\( \Omega = X \)</p>
                <ul class="formula-definition">
                  <li>Not defined yet.</li>
                </ul>
                <p class="formula-line result">Not defined yet.</p>
              </div>
              <ul class="upgrade-list">
                <li>Not defined yet.</li>
              </ul>
              <footer class="card-footer">Not defined yet.</footer>
              <button class="tower-equip-button" type="button" data-tower-toggle="omega">
                Equip Ω
              </button>
            </article>

            <article class="card" data-tower-id="aleph-null" hidden aria-hidden="true">
              <header class="tower-header">
                <span class="tower-tier">Tier XXV</span>
                <h3>ℵ₀ aleph-null tower</h3>
              </header>
              <div class="formula-block">
                <p class="formula-line">\( \aleph_{0} = X \)</p>
                <ul class="formula-definition">
                  <li>Not defined yet.</li>
                </ul>
                <p class="formula-line result">Not defined yet.</p>
              </div>
              <ul class="upgrade-list">
                <li>Not defined yet.</li>
              </ul>
              <footer class="card-footer">Not defined yet.</footer>
              <button class="tower-equip-button" type="button" data-tower-toggle="aleph-null">
                Equip ℵ₀
              </button>
            </article>

            <article class="card" data-tower-id="aleph-one" hidden aria-hidden="true">
              <header class="tower-header">
                <span class="tower-tier">Tier XXVI</span>
                <h3>ℵ₁ aleph-one tower</h3>
              </header>
              <div class="formula-block">
                <p class="formula-line">\( \aleph_{1} = X \)</p>
                <ul class="formula-definition">
                  <li>Not defined yet.</li>
                </ul>
                <p class="formula-line result">Not defined yet.</p>
              </div>
              <ul class="upgrade-list">
                <li>Not defined yet.</li>
              </ul>
              <footer class="card-footer">Not defined yet.</footer>
              <button class="tower-equip-button" type="button" data-tower-toggle="aleph-one">
                Equip ℵ₁
              </button>
            </article>

            <article class="card" data-tower-id="aleph-two" hidden aria-hidden="true">
              <header class="tower-header">
                <span class="tower-tier">Tier XXVII</span>
                <h3>ℵ₂ aleph-two tower</h3>
              </header>
              <div class="formula-block">
                <p class="formula-line">\( \aleph_{2} = X \)</p>
                <ul class="formula-definition">
                  <li>Not defined yet.</li>
                </ul>
                <p class="formula-line result">Not defined yet.</p>
              </div>
              <ul class="upgrade-list">
                <li>Not defined yet.</li>
              </ul>
              <footer class="card-footer">Not defined yet.</footer>
              <button class="tower-equip-button" type="button" data-tower-toggle="aleph-two">
                Equip ℵ₂
              </button>
            </article>

            <article class="card" data-tower-id="aleph-three" hidden aria-hidden="true">
              <header class="tower-header">
                <span class="tower-tier">Tier XXVIII</span>
                <h3>ℵ₃ aleph-three tower</h3>
              </header>
              <div class="formula-block">
                <p class="formula-line">\( \aleph_{3} = X \)</p>
                <ul class="formula-definition">
                  <li>Not defined yet.</li>
                </ul>
                <p class="formula-line result">Not defined yet.</p>
              </div>
              <ul class="upgrade-list">
                <li>Not defined yet.</li>
              </ul>
              <footer class="card-footer">Not defined yet.</footer>
              <button class="tower-equip-button" type="button" data-tower-toggle="aleph-three">
                Equip ℵ₃
              </button>
            </article>

            <article class="card" data-tower-id="aleph-four" hidden aria-hidden="true">
              <header class="tower-header">
                <span class="tower-tier">Tier XXIX</span>
                <h3>ℵ₄ aleph-four tower</h3>
              </header>
              <div class="formula-block">
                <p class="formula-line">\( \aleph_{4} = X \)</p>
                <ul class="formula-definition">
                  <li>Not defined yet.</li>
                </ul>
                <p class="formula-line result">Not defined yet.</p>
              </div>
              <ul class="upgrade-list">
                <li>Not defined yet.</li>
              </ul>
              <footer class="card-footer">Not defined yet.</footer>
              <button class="tower-equip-button" type="button" data-tower-toggle="aleph-four">
                Equip ℵ₄
              </button>
            </article>

            <article class="card" data-tower-id="aleph-five" hidden aria-hidden="true">
              <header class="tower-header">
                <span class="tower-tier">Tier XXX</span>
                <h3>ℵ₅ aleph-five tower</h3>
              </header>
              <div class="formula-block">
                <p class="formula-line">\( \aleph_{5} = X \)</p>
                <ul class="formula-definition">
                  <li>Not defined yet.</li>
                </ul>
                <p class="formula-line result">Not defined yet.</p>
              </div>
              <ul class="upgrade-list">
                <li>Not defined yet.</li>
              </ul>
              <footer class="card-footer">Not defined yet.</footer>
              <button class="tower-equip-button" type="button" data-tower-toggle="aleph-five">
                Equip ℵ₅
              </button>
            </article>

          </div>
        </section>

        <section
          class="panel"
          data-panel="powder"
          id="panel-powder"
          role="tabpanel"
          aria-labelledby="tab-powder"
          hidden
        >
          <section class="powder-stage" id="powder-stage" aria-label="Spire">
            <article class="card powder-simulation" id="powder-simulation-card">
              <div class="powder-basin" id="powder-basin">
                <canvas
                  id="powder-canvas"
                  width="240"
                  height="320"
                  role="img"
                  aria-label="Spire simulation"
                ></canvas>
                <div class="powder-viewport" id="powder-viewport">
                  <div
                    class="powder-wall-hitbox powder-wall-hitbox-left"
                    id="powder-wall-hitbox-left"
                    aria-hidden="true"
                  ></div>
                  <div class="powder-wall powder-wall-left" id="powder-wall-left" aria-hidden="true">
                    <div
                      class="powder-wall-marker powder-crest-marker"
                      id="powder-crest-marker"
                      data-height="Crest 0.00"
                      aria-hidden="true"
                    ></div>
                  </div>
                  <div
                    class="powder-wall-hitbox powder-wall-hitbox-right"
                    id="powder-wall-hitbox-right"
                    aria-hidden="true"
                  ></div>
                  <div class="powder-wall powder-wall-right" id="powder-wall-right" aria-hidden="true">
                    <div class="powder-wall-marker" id="powder-wall-marker" data-height="Peak 0.00" aria-hidden="true"></div>
                    <!-- Display the progress marker on the right wall so it no longer overlaps the crest label. -->
                    <div class="powder-glyph-column" data-powder-glyph-column="right"></div>
                  </div>
                </div>
              </div>
            </article>
          </section>
          <section class="panel-grid powder-summary" aria-label="Flux overview reference">
            <article class="card powder-overview">
              <h3>Flux Overview</h3>
              <dl class="powder-metrics">
                <div>
                  <dt>Total Multiplier</dt>
                  <dd id="powder-total-multiplier">×1.00</dd>
                </div>
                <div>
                  <dt>Sandfall Bonus</dt>
                  <dd id="powder-sand-bonus">+0.00%</dd>
                </div>
                <div>
                  <dt>Dune Channeling</dt>
                  <dd id="powder-dune-bonus">+0.00%</dd>
                </div>
                <div>
                  <dt>Crystal Resonance</dt>
                  <dd id="powder-crystal-bonus">+0.00%</dd>
                </div>
              </dl>
            </article>
            <article class="card powder-mote-stats">
              <h3>Mote Bank Stats</h3>
              <dl class="powder-metrics">
                <!-- Idle mote bank readout relocated from the towers tab to centralize mote tracking. -->
                <div>
                  <dt>Mote Bank</dt>
                  <dd id="powder-mote-bank">0 Motes</dd>
                </div>
                <!-- Fall rate display migrated alongside the bank so both mote flows live in one tab. -->
                <div>
                  <dt>Fall Rate</dt>
                  <dd id="powder-mote-rate">1.00 Motes/sec</dd>
                </div>
                <div>
                  <dt>Idle Multiplier</dt>
                  <dd id="powder-idle-multiplier">0 achievements</dd>
                </div>
              </dl>
            </article>
            <article class="card powder-sigils-card">
              <h3>Sigil Ladder</h3>
              <p>
                Mote height illuminates etched glyphs. Each rung unlocks new research rites once
                the total multiplier meets or exceeds its mark.
              </p>
              <ul class="powder-sigil-list" id="powder-sigil-list">
                <li data-sigil-threshold="1.05">
                  <span class="sigil-name">Boundary Sigil</span>
                  <span class="sigil-note">Stabilize the sandfall to breach ×1.05 flow.</span>
                </li>
                <li data-sigil-threshold="1.15">
                  <span class="sigil-name">Dune Crest Sigil</span>
                  <span class="sigil-note">Raise h to carve channels and reach ×1.15.</span>
                </li>
                <li data-sigil-threshold="1.35">
                  <span class="sigil-name">Crystal Harmonic Sigil</span>
                  <span class="sigil-note">Store a full lattice of charges to strike ×1.35.</span>
                </li>
                <li data-sigil-threshold="1.5">
                  <span class="sigil-name">Archive Sigil</span>
                  <span class="sigil-note">Sustain every ritual to engrave ×1.50 and beyond.</span>
                </li>
              </ul>
            </article>
          </section>

          <!-- Display the player's mote gem inventory and provide a portal into the crafting overlay. -->
          <article class="card powder-gem-inventory-card">
            <h3>Mote Gem Inventory</h3>
            <p class="powder-footnote">
              Every collected gem resonates below so crafting blueprints can reference their current stock.
            </p>
            <ul class="powder-gem-inventory" id="powder-gem-inventory" aria-live="polite"></ul>
            <p class="powder-gem-inventory-empty" id="powder-gem-empty">No mote gems catalogued yet.</p>
            <button class="action-button ghost powder-crafting-button" type="button" id="open-crafting-menu">
              Crafting Menu
            </button>
            <button
              class="powder-mode-toggle"
              type="button"
              id="powder-mode-toggle"
              aria-controls="panel-fluid"
            >
              Unlock Bet Spire
            </button>
          </article>
        </section>

        <section
          class="panel"
          data-panel="fluid"
          id="panel-fluid"
          role="tabpanel"
          aria-labelledby="tab-fluid"
          hidden
        >
          <header class="panel-header">Bet Spire</header>
          <section class="fluid-grid" aria-label="Bet Spire Overview">
            <div class="fluid-simulation-slot" id="fluid-simulation-host">
              <article class="card powder-simulation fluid-simulation-card" id="fluid-simulation-card">
                <div class="powder-basin fluid-basin" id="fluid-basin">
                  <canvas
                    id="fluid-canvas"
                    width="240"
                    height="320"
                    role="img"
                    aria-label="Fluid resonance channel"
                  ></canvas>
                  <div class="powder-viewport fluid-viewport" id="fluid-viewport">
                    <div
                      class="powder-wall-hitbox fluid-wall-hitbox fluid-wall-hitbox-left"
                      id="fluid-wall-hitbox-left"
                      aria-hidden="true"
                    ></div>
                    <div class="powder-wall fluid-wall fluid-wall-left" id="fluid-wall-left" aria-hidden="true">
                      <div class="powder-glyph-column" data-fluid-glyph-column="left"></div>
                    </div>
                    <div
                      class="powder-wall-hitbox fluid-wall-hitbox fluid-wall-hitbox-right"
                      id="fluid-wall-hitbox-right"
                      aria-hidden="true"
                    ></div>
                    <div class="powder-wall fluid-wall fluid-wall-right" id="fluid-wall-right" aria-hidden="true">
                      <div class="powder-glyph-column" data-fluid-glyph-column="right"></div>
                    </div>
                  </div>
                </div>
              </article>
            </div>
            <article class="card fluid-metrics-card">
              <h3>Reservoir Metrics</h3>
              <dl class="fluid-metrics">
                <div>
                  <dt>Reservoir Depth</dt>
                  <dd id="fluid-depth">0.00% full</dd>
                </div>
                <div>
                  <dt>Idle Drop Reservoir</dt>
                  <dd id="fluid-reservoir">0 Drops</dd>
                </div>
                <div>
                  <dt>Condensation Rate</dt>
                  <dd id="fluid-drip-rate">0.00 drops/sec</dd>
                </div>
              </dl>
              <p class="fluid-status-note" id="fluid-status-note">
                Water drops seep from idle reserves and collect within the study.
              </p>
            </article>
            <article class="card fluid-briefing-card">
              <h3>
                <span id="fluid-profile-label">Bet Spire</span>
                <span class="fluid-state-label" id="fluid-state-label">Forming</span>
              </h3>
              <p class="fluid-briefing">
                Observe condensed drops cascading into the spire. Guide the flow to stabilize the lattice and feed the idle
                bank.
              </p>
              <button class="action-button ghost fluid-return-button" type="button" id="fluid-return-button">
                Return to Powderfall
              </button>
            </article>
          </section>
        </section>

        <section
          class="panel"
          data-panel="achievements"
          id="panel-achievements"
          role="tabpanel"
          aria-labelledby="tab-achievements"
          hidden
        >
          <header class="panel-header">Achievements</header>
          <p class="achievement-note">
              Each sealed proof adds <strong>+1 mote per minute</strong> to the idle bank. Tap an icon to
            review its victory details.
          </p>
          <div class="achievement-grid" id="achievement-grid" role="list"></div>
        </section>

        <section
          class="panel"
          data-panel="options"
          id="panel-options"
          role="tabpanel"
          aria-labelledby="tab-options"
          hidden
        >
          <header class="panel-header">Options &amp; Codex</header>
          <div class="panel-grid">
            <article class="card" id="sound-card">
              <h3 id="sound-card-title">Sound</h3>
              <p>Adjust harmonic resonance levels.</p>
              <div class="slider-group" role="group" aria-labelledby="sound-card-title">
                <div class="slider-row">
                  <div class="slider-row-header">
                    <label class="slider-label" for="music-volume">Music</label>
                    <span class="slider-value" id="music-volume-value">50%</span>
                  </div>
                  <input
                    class="slider-input"
                    type="range"
                    id="music-volume"
                    min="0"
                    max="100"
                    step="1"
                    value="50"
                    aria-label="Music volume"
                  />
                </div>
                <div class="slider-row">
                  <div class="slider-row-header">
                    <label class="slider-label" for="sfx-volume">Sound Effects</label>
                    <span class="slider-value" id="sfx-volume-value">50%</span>
                  </div>
                  <input
                    class="slider-input"
                    type="range"
                    id="sfx-volume"
                    min="0"
                    max="100"
                    step="1"
                    value="50"
                    aria-label="Sound effects volume"
                  />
                </div>
              </div>
            </article>
            <article class="card">
              <h3>Visual Theme</h3>
              <p>Switch between aurora and chromatic palettes.</p>
              <button class="action-button ghost" type="button" id="color-scheme-button">
                Palette · Aurora
              </button>
              <button class="action-button ghost" type="button" id="notation-toggle-button">
                Notation · Letters
              </button>
              <!-- Toggle between low and high graphics fidelity. -->
              <button class="action-button ghost" type="button" id="graphics-mode-button">
                Graphics · High
              </button>
              <!-- Toggle to reveal glyph equations inside tower upgrade cards. -->
              <div class="settings-toggle" id="glyph-equation-toggle-row">
                <div class="settings-toggle-text">
                  <span class="settings-toggle-title">Show Glyph Equations</span>
                  <span class="settings-toggle-description"
                    >Reveal Aleph glyph formulas within every tower detail.</span
                  >
                </div>
                <label class="settings-toggle-control" for="glyph-equation-toggle">
                  <input
                    type="checkbox"
                    id="glyph-equation-toggle"
                    class="settings-toggle-input"
                    role="switch"
                    aria-checked="false"
                  />
                  <span class="settings-toggle-slider" aria-hidden="true"></span>
                  <span class="settings-toggle-state" id="glyph-equation-toggle-state">Off</span>
                </label>
              </div>
            </article>
            <article class="card">
              <h3>Field Notes</h3>
              <p>Consult the archivist for a briefing on the current storyline.</p>
              <button class="action-button ghost" type="button" id="open-codex-button">
                Field Notes
              </button>
            </article>
          </div>
          <section class="level-legend codex-roadmap" aria-labelledby="codex-proof-roadmap-title">
            <header class="codex-header">
              <span class="codex-label">Codex</span>
              <h3 id="codex-proof-roadmap-title">Proof Roadmap</h3>
            </header>
            <ul class="set-timeline">
              <li class="set-card active-set">
                <h4>Conjecture Levels 1-5</h4>
                <p>Speculative math under siege. Examples highlight famous unsolved ideas.</p>
              </li>
              <li class="set-card">
                <h4>Corollary Levels 6-10</h4>
                <p>Statements that immediately bloom from the conjecture victories.</p>
              </li>
              <li class="set-card">
                <h4>Lemma Levels 11-15</h4>
                <p>Utility proofs and support tactics that bolster the main argument.</p>
              </li>
              <li class="set-card">
                <h4>Proposition Levels 16-20</h4>
                <p>Solid but modest claims—expect compound paths and multi-route assaults.</p>
              </li>
              <li class="set-card">
                <h4>Theorem Levels 21-25</h4>
                <p>Major revelations guarded by elite enemy archetypes.</p>
              </li>
              <li class="set-card">
                <h4>Axiom Levels 26-30</h4>
                <p>Foundational truths; everything loops back to primal glyph geometry.</p>
              </li>
            </ul>
          </section>
          <article class="card powder-log-card codex-lab-chronicle">
            <h3>Lab Chronicle</h3>
            <p class="powder-footnote">Recent experiments echo here for quick review.</p>
            <ul class="powder-log" id="powder-log" aria-live="polite" aria-label="Recent mote experiments"></ul>
            <p class="powder-log-empty" id="powder-log-empty">No experiments recorded yet.</p>
          </article>
          <section class="enemy-codex" id="enemy-codex-section" aria-live="polite" tabindex="-1">
            <header class="subsection-title">Enemy Codex</header>
            <div class="codex-controls">
              <button class="action-button ghost" type="button" id="codex-options-button">
                Open Options
              </button>
              <label class="developer-mode-toggle" for="codex-developer-mode">
                <input type="checkbox" id="codex-developer-mode" />
                Developer Mode — unlock all towers, levels, and entries
              </label>
              <button class="developer-reset-button" type="button" id="developer-reset-button">
                Delete Player Data
              </button>
              <p class="developer-mode-note" id="codex-developer-note" hidden>
                Developer mode active: all content is unlocked for rapid iteration.
              </p>
              <div class="developer-control-panel" id="developer-control-panel" hidden aria-hidden="true">
                <div class="developer-control-field">
                  <label for="developer-mote-bank">Idle mote bank</label>
                  <input
                    type="number"
                    id="developer-mote-bank"
                    data-developer-field="moteBank"
                    min="0"
                    step="1"
                    inputmode="numeric"
                  />
                  <p class="developer-control-hint">Override the stored mote reserve.</p>
                </div>
                <div class="developer-control-field">
                  <label for="developer-compact-basin">Compact basin autosave (smaller saves)</label>
                  <input
                    type="checkbox"
                    id="developer-compact-basin"
                    data-developer-field="compactBasin"
                  />
                  <p class="developer-control-note">
                    When enabled (default), the game saves a compact baseline + dune descriptor
                    for the mote basin to reduce storage size. Disable to preserve full grain positions.
                  </p>
                </div>
                <div class="developer-control-field">
                  <label for="developer-mote-rate">Mote fall rate</label>
                  <input
                    type="number"
                    id="developer-mote-rate"
                    data-developer-field="moteRate"
                    min="0"
                    step="0.01"
                    inputmode="decimal"
                  />
                  <p class="developer-control-hint">Set motes dispensed per second.</p>
                </div>
                <div class="developer-control-field">
                  <label for="developer-start-thero">Base start þ</label>
                  <input
                    type="number"
                    id="developer-start-thero"
                    data-developer-field="startThero"
                    min="0"
                    step="1"
                    inputmode="numeric"
                  />
                  <p class="developer-control-hint">Adjust starting Thero before multipliers.</p>
                </div>
                <div class="developer-control-field">
                  <label for="developer-thero-multiplier">Thero multiplier</label>
                  <input
                    type="number"
                    id="developer-thero-multiplier"
                    data-developer-field="theroMultiplier"
                    min="0"
                    step="0.01"
                    inputmode="decimal"
                  />
                  <p class="developer-control-hint">
                    Override the starting Thero multiplier. Leave blank to follow progression.
                  </p>
                </div>
                <div class="developer-control-field">
                  <label for="developer-glyphs">Glyph reserves</label>
                  <input
                    type="number"
                    id="developer-glyphs"
                    data-developer-field="glyphs"
                    min="0"
                    step="1"
                    inputmode="numeric"
                  />
                  <p class="developer-control-hint">Set total glyph currency available.</p>
                </div>
              </div>
            </div>
            <p class="enemy-codex-note" id="enemy-codex-empty">Encounter enemies to unlock their entries.</p>
            <p class="enemy-codex-note" id="enemy-codex-note" hidden>
              Known enemy glyphs and Scintilla Glyph lore from the Tower of Inspiration are
              cataloged below for quick reference.
            </p>
            <div class="enemy-grid" id="enemy-codex-list" role="list"></div>
          </section>
        </section>
      </main>

      <nav class="tab-bar" aria-label="Primary" role="tablist">
        <button
          class="tab-button active"
          data-tab="tower"
          id="tab-tower"
          type="button"
          role="tab"
          aria-label="Tower Stage"
          aria-controls="panel-tower"
          aria-selected="true"
          aria-pressed="true"
        >
          <span class="tab-icon">℘</span>
          <span class="tab-label">Stage</span>
        </button>
        <button
          class="tab-button"
          data-tab="towers"
          id="tab-towers"
          type="button"
          role="tab"
          aria-label="Towers"
          aria-controls="panel-towers"
          aria-selected="false"
          aria-pressed="false"
        >
          <span class="tab-icon">α</span>
          <span class="tab-label">Towers</span>
          <!-- Indicator for unused glyph currency relocated beneath the tab title. -->
          <span class="tab-icon-badge tab-icon-badge--glyphs" id="tab-glyph-badge" hidden>0</span>
        </button>
        <!-- Split the spire tab so the lower half routes to the Bet Spire once unlocked. -->
        <div class="tab-button-stack" id="tab-powder-stack" role="presentation" aria-hidden="false">
          <button
            class="tab-button tab-button--stacked"
            data-tab="powder"
            id="tab-powder"
            type="button"
            role="tab"
            aria-label="Aleph Spire"
            aria-controls="panel-powder"
            aria-selected="false"
            aria-pressed="false"
          >
            <span class="tab-icon">ℵ</span>
            <span class="tab-label">Spire</span>
            <!-- Persistent mote bank indicator relocated beneath the tab title. -->
            <span class="tab-icon-badge tab-icon-badge--motes" id="tab-mote-badge">0.00</span>
          </button>
          <button
            class="tab-button tab-button--stacked tab-button--stacked-fluid"
            data-tab="fluid"
            id="tab-fluid"
            type="button"
            role="tab"
            aria-label="Bet Spire"
            aria-controls="panel-fluid"
            aria-selected="false"
            aria-pressed="false"
            hidden
          >
            <span class="tab-icon">ב</span>
            <span class="tab-label">Bet</span>
            <span class="tab-icon-badge tab-icon-badge--fluid" id="tab-fluid-badge" hidden>0</span>
          </button>
        </div>
        <button
          class="tab-button"
          data-tab="achievements"
          id="tab-achievements"
          type="button"
          role="tab"
          aria-label="Achievements"
          aria-controls="panel-achievements"
          aria-selected="false"
          aria-pressed="false"
        >
          <span class="tab-icon">∮</span>
          <span class="tab-label">Proofs</span>
        </button>
        <button
          class="tab-button"
          data-tab="options"
          id="tab-options"
          type="button"
          role="tab"
          aria-label="Options"
          aria-controls="panel-options"
          aria-selected="false"
          aria-pressed="false"
        >
          <span class="tab-icon">
          <span class="tab-icon">⧖</span>
          </span>
          <span class="tab-label">Codex</span>
        </button>
      </nav>
    </div>
    <div
      class="level-overlay variable-library-overlay"
      id="variable-library-overlay"
      role="dialog"
      aria-modal="true"
      aria-hidden="true"
      hidden
      aria-labelledby="variable-library-title"
    >
      <div class="overlay-panel">
        <button
          class="overlay-close"
          type="button"
          data-variable-library-close
          aria-label="Close variable glossary"
        >
          &times;
        </button>
        <p class="overlay-label">Glyph Variables</p>
        <h2 class="overlay-title" id="variable-library-title">Variable Glossary</h2>
        <p class="overlay-example">
          Review every symbol unlocked across your towers and spectral cohorts.
        </p>
        <ul class="variable-library-list" id="variable-library-list" role="list"></ul>
        <p class="overlay-instruction">Tap outside or press Esc to close.</p>
      </div>
    </div>
    <div
      class="level-overlay upgrade-overlay"
      id="upgrade-matrix-overlay"
      role="dialog"
      aria-modal="true"
      aria-hidden="true"
      hidden
      aria-labelledby="upgrade-matrix-title"
    >
      <div class="overlay-panel">
        <button
          class="overlay-close"
          type="button"
          data-overlay-close
          aria-label="Close upgrade matrix"
        >
          &times;
        </button>
        <p class="overlay-label">Merge Reference</p>
        <h2 class="overlay-title" id="upgrade-matrix-title">Upgrade Matrix</h2>
        <p class="overlay-example">
          Review how glyph towers ascend, their base lattice costs, and the form unlocked by each merge.
        </p>
        <div class="upgrade-matrix-grid" id="upgrade-matrix-grid" role="list"></div>
        <p class="overlay-instruction">Tap outside or press Esc to close.</p>
      </div>
    </div>
    <div
      class="level-overlay tower-upgrade-overlay"
      id="tower-upgrade-overlay"
      role="dialog"
      aria-modal="true"
      aria-hidden="true"
      hidden
      aria-labelledby="tower-upgrade-title"
    >
      <div class="overlay-panel tower-upgrade-panel">
        <button
          class="overlay-close"
          type="button"
          data-tower-upgrade-close
          aria-label="Close tower upgrade menu"
        >
          &times;
        </button>
        <p class="overlay-label">Glyph Variable Lattice</p>
        <div class="tower-upgrade-header">
          <figure class="tower-upgrade-icon" id="tower-upgrade-icon" aria-hidden="true"></figure>
          <div class="tower-upgrade-heading">
            <h2 class="overlay-title" id="tower-upgrade-title">Tower Equation</h2>
            <p class="tower-upgrade-tier" id="tower-upgrade-tier"></p>
            <p class="tower-upgrade-glyphs" id="tower-upgrade-glyphs">Available Glyphs: 0</p>
          </div>
        </div>
        <div class="tower-upgrade-equations">
          <section class="tower-upgrade-equation" aria-labelledby="tower-upgrade-base-label">
            <h3 class="tower-upgrade-equation-label" id="tower-upgrade-base-label">Base Equation</h3>
            <p class="tower-upgrade-formula" id="tower-upgrade-base"></p>
            <p class="tower-upgrade-formula tower-upgrade-formula--values" id="tower-upgrade-base-values"></p>
          </section>
        </div>
        <div class="tower-upgrade-variables" id="tower-upgrade-variables" role="list"></div>
        <p class="tower-upgrade-note" id="tower-upgrade-note"></p>
        <p class="overlay-instruction">Tap outside or press Esc to close.</p>
      </div>
    </div>
    <div
      class="level-overlay field-notes-overlay"
      id="field-notes-overlay"
      role="dialog"
      aria-modal="true"
      aria-hidden="true"
      tabindex="-1"
      hidden
    >
      <div class="overlay-panel field-notes-panel" role="document" aria-labelledby="field-notes-title">
        <button class="overlay-close" type="button" id="field-notes-close" aria-label="Close field notes">×</button>
        <figure class="field-notes-figure">
          <img
            src="./assets/sprites/glyph_book_glowing.png"
            alt="A glowing glyph codex radiates swirling sigils."
          />
          <figcaption>Glowing Glyph Codex</figcaption>
        </figure>
        <p class="overlay-label">Field Notes Dispatch</p>
        <h2 class="overlay-title" id="field-notes-title">The Tower of Inspiration Briefing</h2>
        <div class="field-notes-copy" id="field-notes-copy">
          <article class="field-notes-page field-notes-page--active" data-page-index="0" tabindex="0">
            <figure class="field-notes-page-figure">
              <img
                class="field-notes-page-image"
                src="./assets/field notes/field_notes_page_1.png"
                alt="Illustrated field notes detailing the sigil-laced ramparts guarding the tower."
                loading="eager"
              />
              <figcaption class="field-notes-page-caption">Field Notes · Page I — Rampart lattice schematics.</figcaption>
            </figure>
          </article>
          <article class="field-notes-page" data-page-index="1" tabindex="-1" aria-hidden="true">
            <figure class="field-notes-page-figure">
              <img
                class="field-notes-page-image"
                src="./assets/field notes/field_notes_page_2.png"
                alt="Sketches cataloguing powder flow experiments and glyph reactions."
                loading="lazy"
              />
              <figcaption class="field-notes-page-caption">Field Notes · Page II — Powder flow resonance studies.</figcaption>
            </figure>
          </article>
          <article class="field-notes-page" data-page-index="2" tabindex="-1" aria-hidden="true">
            <figure class="field-notes-page-figure">
              <img
                class="field-notes-page-image"
                src="./assets/field notes/field_notes_page_3.png"
                alt="Logbook page comparing enemy formations with counter-formulae."
                loading="lazy"
              />
              <figcaption class="field-notes-page-caption">Field Notes · Page III — Counter-formation annotations.</figcaption>
            </figure>
          </article>
          <article class="field-notes-page" data-page-index="3" tabindex="-1" aria-hidden="true">
            <p>
              Welcome, Warden. I am Thero, archivist of the glyph lattice. Your arrival coincides with a surge of
              <strong>mote turbulence</strong> washing against the tower's perimeter.
            </p>
            <p>
              Our scouts report that rival scholars have animated rogue proofs. Each wave they summon is tuned to unravel the
              equations binding our defenses. Hold these observations close:
            </p>
          </article>
          <article class="field-notes-page" data-page-index="4" tabindex="-1" aria-hidden="true">
            <ul class="field-notes-list">
              <li>The <strong>Scintilla Glyph</strong> at the summit regulates every mote current—lose it and the lattice collapses.</li>
              <li>
                <strong>Chronoglyph wards</strong> along the ramparts can bend time briefly. Use their cadence to reset your
                ordinals and stagger enemy advances.
              </li>
              <li>
                When a wave fractures, sift the motes it leaves behind. Their resonance seeds new towers faster than any quarry.
              </li>
            </ul>
            <p>
              Return once the next theorem is secured. I will inscribe your progress and prepare the following expedition. The
              codex grows because of your vigilance.
            </p>
          </article>
        </div>
        <div class="field-notes-pagination" id="field-notes-pagination">
          <button class="field-notes-page-button" type="button" id="field-notes-prev" aria-label="Previous field notes page" disabled>
            ‹
          </button>
          <span class="field-notes-page-indicator" id="field-notes-page-indicator">Page 1 of 5</span>
          <button class="field-notes-page-button" type="button" id="field-notes-next" aria-label="Next field notes page">
            ›
          </button>
        </div>
      </div>
    </div>
    <!-- Crafting overlay mirrors tower pop-ups while outlining gem-driven fabrication stubs. -->
    <div
      class="level-overlay crafting-overlay"
      id="crafting-overlay"
      role="dialog"
      aria-modal="true"
      aria-hidden="true"
      tabindex="-1"
      hidden
    >
      <div class="overlay-panel crafting-panel" role="document" aria-labelledby="crafting-title">
        <button class="overlay-close" type="button" id="crafting-close" aria-label="Close crafting menu">×</button>
        <p class="overlay-label">Arcane Fabrication</p>
        <h2 class="overlay-title" id="crafting-title">Gemcraft Assembly</h2>
        <p class="crafting-intro">
          Forge amplifiers and pylons by channeling mote gems into latent tower schematics. Recipes below are
          prototypes awaiting balance.
        </p>
        <section
          class="crafted-equipment-section"
          id="crafted-equipment-section"
          aria-labelledby="crafted-equipment-title"
        >
          <header class="crafted-equipment-header">
            <h3 class="crafted-equipment-title" id="crafted-equipment-title">Crafted Equipment</h3>
            <p class="crafted-equipment-note">
              Assign relics to towers to reshape their glyph lattice. Selecting a new tower automatically frees the previous socket.
            </p>
          </header>
          <ul
            class="crafted-equipment-list"
            id="crafted-equipment-list"
            role="list"
            aria-live="polite"
            aria-label="Crafted equipment"
          ></ul>
          <p class="crafted-equipment-empty" id="crafted-equipment-empty" aria-hidden="true">
            No equipment forged yet.
          </p>
        </section>
        <ul class="crafting-list" id="crafting-list" role="list"></ul>
        <p class="overlay-instruction">Tap outside or press Esc to close.</p>
      </div>
    </div>

    <div class="level-overlay" id="level-overlay" role="dialog" aria-modal="true" aria-hidden="true" hidden>
      <div class="overlay-panel">
        <p class="overlay-label" id="overlay-level"></p>
        <h2 class="overlay-title" id="overlay-title"></h2>
        <p class="overlay-example" id="overlay-example"></p>
        <figure class="overlay-preview" id="overlay-preview" aria-hidden="true" hidden></figure>
        <dl class="overlay-metrics">
          <div>
            <dt>Mode</dt>
            <dd id="overlay-mode">—</dd>
          </div>
          <div>
            <dt>Run Length</dt>
            <dd id="overlay-duration">—</dd>
          </div>
          <div>
            <dt>Starting Thero</dt>
            <dd id="overlay-start-thero">—</dd>
          </div>
          <div>
            <dt>Rewards</dt>
            <dd id="overlay-rewards">—</dd>
          </div>
        </dl>
        <p class="overlay-last" id="overlay-last">No attempts yet.</p>
        <p class="overlay-instruction">Tap to enter</p>
      </div>
    </div>
    <script type="module" src="./assets/main.js"></script>
  </body>
</html>
